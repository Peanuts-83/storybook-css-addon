{"version":3,"sources":["../packages/css-viewer-addon/src/constants.ts","../packages/css-viewer-addon/src/withRoundTrip.ts","../packages/css-viewer-addon/src/preview.ts"],"names":["ADDON_ID","TOOL_ID","EVENTS","check","canvas","divs","all","element","div","withRoundTrip","storyFn","context","canvasElement","emit","useChannel","useEffect","preview","preview_default"],"mappings":"sEAAaA,IAAAA,CAAAA,CAAW,uBACXC,CAKN,IAAMC,CAAS,CAAA,CACpB,MAAQ,CAAA,CAAA,EAAGF,CAAQ,CACnB,OAAA,CAAA,CAAA,OAAA,CAAS,CAAGA,EAAAA,CAAQ,UACtB,CCGA,CAAA,IAAMG,CAAQ,CAAA,CAACC,CAAqB,CAAA,UAAA,CAAW,QAAqB,GAAA,CAClE,IAAMC,CAAOD,CAAAA,CAAAA,CAAO,gBAAiB,CAAA,KAAK,CACpCE,CAAAA,CAAAA,CAAMF,CAAO,CAAA,gBAAA,CAAiB,GAAG,CAEvC,CAAA,OAAO,CACL,IAAA,CAAM,KAAM,CAAA,IAAA,CAAKC,CAAI,CAAA,CAClB,OAAQE,CAAYA,EAAAA,CAAAA,CAAQ,UAAW,CAAA,MAAA,CAAS,CAAC,CACjD,CAAA,GAAA,CAAKC,CAAQA,EAAAA,CAAAA,CAAI,uBAAuB,CAAA,CAC3C,MAAQ,CAAA,KAAA,CAAM,IAAKF,CAAAA,CAAG,CACnB,CAAA,MAAA,CAAQC,GAAYA,CAAQ,CAAA,YAAA,CAAa,OAAO,CAAC,CACjD,CAAA,GAAA,CAAKA,CAAYA,EAAAA,CAAAA,CAAQ,uBAAuB,CACrD,CACF,CAAA,CAEaE,CAAmC,CAAA,CAACC,CAASC,CAAAA,CAAAA,GAAY,CACpE,IAAMC,CAAAA,CAAgBD,CAAQ,CAAA,aAAA,CACxBE,EAAOC,qBAAW,CAAA,CACtB,CAACZ,CAAAA,CAAO,OAAO,EAAG,IAAM,CACtBW,CAAAA,CAAKX,CAAO,CAAA,MAAA,CAAQC,CAAMS,CAAAA,CAAa,CAAC,EAC1C,CACF,CAAC,CAAA,CACD,OAAAG,oBAAAA,CAAU,IAAM,CACdF,EAAKX,CAAO,CAAA,MAAA,CAAQC,CAAMS,CAAAA,CAAa,CAAC,EAC1C,CAAC,CAAA,CAEMF,GACT,CAAA,CCnCMM,IAAAA,CAAAA,CAAwC,CAC5C,UAAY,CAAA,CAACP,CAAa,CAC5B,EAEOQ,CAAQD,CAAAA","file":"preview.cjs","sourcesContent":["export const ADDON_ID = \"storybook-css-display\";\nexport const TOOL_ID = `${ADDON_ID}/tool`;\nexport const PANEL_ID = `${ADDON_ID}/panel`;\nexport const TAB_ID = `${ADDON_ID}/tab`;\nexport const KEY = `css-display`;\n\nexport const EVENTS = {\n  RESULT: `${ADDON_ID}/result`,\n  REQUEST: `${ADDON_ID}/request`,\n};\n\nexport const FORMAT = {\n  CSS: \"css\",\n  LESS: 'less',\n  SASS: \"sass\",\n  SCSS: \"scss\",\n  STYL: \"styl\"\n}","import { Result } from \"./types\";\nimport { useEffect } from \"storybook/internal/preview-api\";\nimport { useChannel } from \"storybook/internal/preview-api\";\nimport type { DecoratorFunction } from \"storybook/internal/types\";\nimport { EVENTS } from \"./constants\";\n\n/**\n * This is an example of a function that performs some sort of analysis on the\n * canvas. In this example, it returns the bounding rectangles for elements that\n * - have a style attribute\n * - are divs with fewer than 2 childNodes\n */\nconst check = (canvas: ParentNode = globalThis.document): Result => {\n  const divs = canvas.querySelectorAll(\"div\");\n  const all = canvas.querySelectorAll(\"*\");\n\n  return {\n    divs: Array.from(divs)\n      .filter((element) => element.childNodes.length < 2)\n      .map((div) => div.getBoundingClientRect()),\n    styled: Array.from(all)\n      .filter((element) => element.hasAttribute(\"style\"))\n      .map((element) => element.getBoundingClientRect()),\n  };\n};\n\nexport const withRoundTrip: DecoratorFunction = (storyFn, context) => {\n  const canvasElement = context.canvasElement as ParentNode;\n  const emit = useChannel({\n    [EVENTS.REQUEST]: () => {\n      emit(EVENTS.RESULT, check(canvasElement));\n    },\n  });\n  useEffect(() => {\n    emit(EVENTS.RESULT, check(canvasElement));\n  });\n\n  return storyFn();\n};\n","import type { ProjectAnnotations, Renderer } from \"storybook/internal/types\";\nimport { withRoundTrip } from \"./withRoundTrip\";\n\nconst preview: ProjectAnnotations<Renderer> = {\n  decorators: [withRoundTrip]\n};\n\nexport default preview;\n"]}